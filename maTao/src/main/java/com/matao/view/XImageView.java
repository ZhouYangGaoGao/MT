package com.matao.view;import android.content.Context;import android.graphics.Bitmap;import android.graphics.drawable.BitmapDrawable;import android.util.AttributeSet;import android.util.DisplayMetrics;import android.view.ViewGroup.LayoutParams;import android.widget.ImageView;public class XImageView extends ImageView {	public XImageView(Context context) {		this(context, null);	}	public XImageView(Context context, AttributeSet attrs) {		this(context, attrs, 0);	}	public XImageView(Context context, AttributeSet attrs, int defStyle) {		super(context, attrs, defStyle);	}	/** 位图对象 */	private Bitmap bitmap = null;	/** 屏幕的分辨率 */	private DisplayMetrics dm;	/**	 * 根据屏幕和图片宽高比例改变控件宽高	 * 	 * 作者:ZhouYang	 * 	 * 2015-6-17下午4:47:06	 * 	 */	private void init() {		Context context = getContext();		// 获取屏幕分辨率,需要根据分辨率来使用图片居中		dm = context.getResources().getDisplayMetrics();		setDrawingCacheEnabled(true);		Bitmap bitmap = getDrawingCache(true);		// 根据MyImageView来获取bitmap对象		BitmapDrawable bd = (BitmapDrawable) this.getDrawable();		if (bd != null) {			bitmap = bd.getBitmap();			w = bitmap.getWidth();			h = bitmap.getHeight();			x = h / (float) w;		}		int ww = (dm.widthPixels - 4) / 2;		int hh = (int) (ww * x);		LayoutParams lp = this.getLayoutParams();		lp.width = (int) (ww * 1.01);		lp.height = hh;		this.setLayoutParams(lp);		setDrawingCacheEnabled(false);		this.setImageBitmap(bitmap);	}	@Override	protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {		super.onMeasure(widthMeasureSpec, heightMeasureSpec);		init();	}	private float x = 0f;	private int w = 0;	private int h = 0;}